--- backend/Valora.Api/Extensions/ServiceCollectionExtensions.cs
+++ backend/Valora.Api/Extensions/ServiceCollectionExtensions.cs
@@ -21,46 +21,7 @@
         services.AddCors(options =>
         {
             options.AddDefaultPolicy(policy =>
-            {
-                var configOrigins = configuration.GetSection("AllowedOrigins").Get<string[]>() ?? Array.Empty<string>();
-
-                // 1. Filter config origins (remove nulls/whitespace, trim)
-                var validOrigins = configOrigins.Where(o => !string.IsNullOrWhiteSpace(o)).Select(o => o.Trim()).ToList();
-
-                // 2. If empty, try environment variables
-                if (validOrigins.Count == 0)
-                {
-                    var envOrigins = configuration["ALLOWED_ORIGINS"];
-                    if (!string.IsNullOrEmpty(envOrigins))
-                    {
-                        validOrigins.AddRange(envOrigins.Split(",", StringSplitOptions.RemoveEmptyEntries | StringSplitOptions.TrimEntries));
-                    }
-                }
-
-                // 3. Fallback to ALLOWED_HOSTS if still empty (common user expectation)
-                if (validOrigins.Count == 0)
-                {
-                    var allowedHosts = configuration["ALLOWED_HOSTS"];
-                    if (allowedHosts == "*")
-                    {
-                        validOrigins.Add("*");
-                    }
-                }
-
-                // 4. Configure policy
-                if (validOrigins.Any(o => o == "*"))
-                {
-                    policy.AllowAnyOrigin()
-                          .AllowAnyMethod()
-                          .AllowAnyHeader();
-                }
-                else if (validOrigins.Count > 0)
-                {
-                    policy.WithOrigins(validOrigins.ToArray())
-                          .AllowAnyMethod()
-                          .AllowAnyHeader();
-                }
-                else
-                {
-                    // Fallback logic
-                    if (environment.IsDevelopment() || environment.IsEnvironment("Testing"))
-                    {
-                        // In development, if no origins are specified, allow any origin
-                        // to support various mobile emulators and local web ports.
-                        policy.AllowAnyOrigin()
-                              .AllowAnyMethod()
-                              .AllowAnyHeader();
-                    }
-                    else
-                    {
-                        // In production, do NOT allow any origin by default.
-                        // This forces explicit configuration.
-                        // A warning will be logged at startup if no origins are configured.
-                        policy.SetIsOriginAllowed(origin => false);
-                    }
-                }
-            });
+                ConfigureCorsPolicy(policy, configuration, environment));
         });

         return services;
     }

+    private static void ConfigureCorsPolicy(Microsoft.AspNetCore.Cors.Infrastructure.CorsPolicyBuilder policy, IConfiguration configuration, IHostEnvironment environment)
+    {
+        var configOrigins = configuration.GetSection("AllowedOrigins").Get<string[]>() ?? Array.Empty<string>();
+
+        var validOrigins = configOrigins.Where(o => !string.IsNullOrWhiteSpace(o)).Select(o => o.Trim()).ToList();
+
+        if (validOrigins.Count == 0)
+        {
+            var envOrigins = configuration["ALLOWED_ORIGINS"];
+            if (!string.IsNullOrEmpty(envOrigins))
+            {
+                validOrigins.AddRange(envOrigins.Split(",", StringSplitOptions.RemoveEmptyEntries | StringSplitOptions.TrimEntries));
+            }
+        }
+
+        if (validOrigins.Count == 0)
+        {
+            var allowedHosts = configuration["ALLOWED_HOSTS"];
+            if (allowedHosts == "*")
+            {
+                validOrigins.Add("*");
+            }
+        }
+
+        if (validOrigins.Any(o => o == "*"))
+        {
+            policy.AllowAnyOrigin().AllowAnyMethod().AllowAnyHeader();
+        }
+        else if (validOrigins.Count > 0)
+        {
+            policy.WithOrigins(validOrigins.ToArray()).AllowAnyMethod().AllowAnyHeader();
+        }
+        else
+        {
+            if (environment.IsDevelopment() || environment.IsEnvironment("Testing"))
+            {
+                policy.AllowAnyOrigin().AllowAnyMethod().AllowAnyHeader();
+            }
+            else
+            {
+                policy.SetIsOriginAllowed(origin => false);
+            }
+        }
+    }
+
     public static void LogCorsWarning(this WebApplication app)
     {
@@ -194,76 +155,75 @@
             var permitLimitStrict = (configStrict.HasValue && configStrict.Value > 0) ? configStrict.Value : (isTesting ? 1000 : 1000);
             var permitLimitFixed = (configFixed.HasValue && configFixed.Value > 0) ? configFixed.Value : (isTesting ? 1000 : 10000);

-            // Policy: "auth"
-            options.AddPolicy(Valora.Api.Constants.RateLimitPolicies.Auth, context =>
-            {
-                var partitionKey = context.User.Identity?.IsAuthenticated == true
-                    ? context.User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value ?? context.Connection.RemoteIpAddress?.ToString() ?? "anonymous"
-                    : context.Connection.RemoteIpAddress?.ToString() ?? "anonymous";
-
-                return RateLimitPartition.GetFixedWindowLimiter(partitionKey,
-                    _ => new FixedWindowRateLimiterOptions
-                    {
-                        PermitLimit = permitLimitAuth,
-                        Window = TimeSpan.FromMinutes(1),
-                        QueueProcessingOrder = QueueProcessingOrder.OldestFirst,
-                        QueueLimit = 0
-                    });
-            });
-
-            // Policy: "strict"
-            options.AddPolicy(Valora.Api.Constants.RateLimitPolicies.Strict, context =>
-            {
-                if (context.User.IsInRole("Admin"))
-                {
-                    return RateLimitPartition.GetNoLimiter("Admin");
-                }
-
-                var partitionKey = context.User.Identity?.IsAuthenticated == true
-                    ? context.User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value ?? context.Connection.RemoteIpAddress?.ToString() ?? "anonymous"
-                    : context.Connection.RemoteIpAddress?.ToString() ?? "anonymous";
-
-                return RateLimitPartition.GetFixedWindowLimiter(partitionKey,
-                    _ => new FixedWindowRateLimiterOptions
-                    {
-                        PermitLimit = permitLimitStrict,
-                        Window = TimeSpan.FromMinutes(1),
-                        QueueProcessingOrder = QueueProcessingOrder.OldestFirst,
-                        QueueLimit = queueLimitStrict
-                    });
-            });
-
-            // Policy: "fixed"
-            options.AddPolicy(Valora.Api.Constants.RateLimitPolicies.Fixed, context =>
-            {
-                if (context.User.IsInRole("Admin"))
-                {
-                    return RateLimitPartition.GetNoLimiter("Admin");
-                }
-
-                var partitionKey = context.User.Identity?.IsAuthenticated == true
-                    ? context.User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value ?? context.Connection.RemoteIpAddress?.ToString() ?? "anonymous"
-                    : context.Connection.RemoteIpAddress?.ToString() ?? "anonymous";
-
-                return RateLimitPartition.GetFixedWindowLimiter(partitionKey,
-                    _ => new FixedWindowRateLimiterOptions
-                    {
-                        PermitLimit = permitLimitFixed,
-                        Window = TimeSpan.FromMinutes(1),
-                        QueueProcessingOrder = QueueProcessingOrder.OldestFirst,
-                        QueueLimit = queueLimitFixed
-                    });
-            });
+            ConfigureAuthRateLimit(options, permitLimitAuth);
+            ConfigureStrictRateLimit(options, permitLimitStrict, queueLimitStrict);
+            ConfigureFixedRateLimit(options, permitLimitFixed, queueLimitFixed);
         });

         return services;
     }
+
+    private static void ConfigureAuthRateLimit(RateLimiterOptions options, int permitLimit)
+    {
+        options.AddPolicy(Valora.Api.Constants.RateLimitPolicies.Auth, context =>
+        {
+            var partitionKey = GetPartitionKey(context);
+            return RateLimitPartition.GetFixedWindowLimiter(partitionKey,
+                _ => new FixedWindowRateLimiterOptions
+                {
+                    PermitLimit = permitLimit,
+                    Window = TimeSpan.FromMinutes(1),
+                    QueueProcessingOrder = QueueProcessingOrder.OldestFirst,
+                    QueueLimit = 0
+                });
+        });
+    }
+
+    private static void ConfigureStrictRateLimit(RateLimiterOptions options, int permitLimit, int queueLimit)
+    {
+        options.AddPolicy(Valora.Api.Constants.RateLimitPolicies.Strict, context =>
+        {
+            if (context.User.IsInRole("Admin"))
+            {
+                return RateLimitPartition.GetNoLimiter("Admin");
+            }
+            var partitionKey = GetPartitionKey(context);
+            return RateLimitPartition.GetFixedWindowLimiter(partitionKey,
+                _ => new FixedWindowRateLimiterOptions
+                {
+                    PermitLimit = permitLimit,
+                    Window = TimeSpan.FromMinutes(1),
+                    QueueProcessingOrder = QueueProcessingOrder.OldestFirst,
+                    QueueLimit = queueLimit
+                });
+        });
+    }
+
+    private static void ConfigureFixedRateLimit(RateLimiterOptions options, int permitLimit, int queueLimit)
+    {
+        options.AddPolicy(Valora.Api.Constants.RateLimitPolicies.Fixed, context =>
+        {
+            if (context.User.IsInRole("Admin"))
+            {
+                return RateLimitPartition.GetNoLimiter("Admin");
+            }
+            var partitionKey = GetPartitionKey(context);
+            return RateLimitPartition.GetFixedWindowLimiter(partitionKey,
+                _ => new FixedWindowRateLimiterOptions
+                {
+                    PermitLimit = permitLimit,
+                    Window = TimeSpan.FromMinutes(1),
+                    QueueProcessingOrder = QueueProcessingOrder.OldestFirst,
+                    QueueLimit = queueLimit
+                });
+        });
+    }
+
+    private static string GetPartitionKey(HttpContext context)
+    {
+        return context.User.Identity?.IsAuthenticated == true
+            ? context.User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value ?? context.Connection.RemoteIpAddress?.ToString() ?? "anonymous"
+            : context.Connection.RemoteIpAddress?.ToString() ?? "anonymous";
+    }
 }
